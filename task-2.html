<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">
<title>??Title??</title>
</head>
<body>
<!-- <script src="http://localhost:8001/js/lib/jquery&#45;1.11.0.js"></script> -->
<!-- <script src="http://localhost:8001/js/lib/underscore&#45;1.4.4.js"></script> -->
<!-- <script src="http://localhost:8001/js/lib/backbone&#45;1.1.1.js"></script> -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.2/underscore-min.js"></script> 
<script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.marionette/2.0.3/backbone.marionette.min.js"></script>
<script>


var proxiedSync = Backbone.sync;


//var Users = Backbone.Collection.extend({
//    url: "http://backbonejs-beginner.herokuapp.com/users"       // full url is specified
//});

// Above works but this the following is cleaner: 

// $.ajaxPrefilter( function( options, originalOptions, jqXHR ) {
//     options.url = 'https://itunes.apple.com/' + options.url;
// });

var Albums = Backbone.Collection.extend({
    // url: "lookup?id=137057909&entity=album"   // using $.ajaxPrefilter(), only have to specified filename, you can ommit protocal, port, domain, and path        
    url: "https://itunes.apple.com/lookup?id=137057909&entity=album"   // using $.ajaxPrefilter(), only have to specified filename, you can ommit protocal, port, domain, and path        
    , sync : function(method, model, options) {
        options.timeout = 10000;
        options.dataType = "jsonp";
        return Backbone.sync(method, model, options);
    }
});

var AlbumsView = Backbone.View.extend({
    initialize: function(){
        console.log('view initializes')
        var albums = new Albums();
        albums.fetch({
            success: function (args) {
                /* on success, content will goes here */
                console.log('CONTENT IS HERE', args);      //<---- see v21-21-b_this-in-render.html about $el 

            }
        });
    }
    , el: 'body'
    , render: function () {
        var that = this;  //<---- see v21-21-b_this-in-render.html
        console.log("in render() this is: ", this.$el.html());
        return this;
    }
});




var Router = Backbone.Router.extend({
    routes: {
        ""         : "home",
    }
});

var albumsView = new AlbumsView();
var router = new Router;

router.on('route:home', function() {    // listen on rout
    albumsView.render();
    console.log('router is home');
})


Backbone.history.start();



</script>
</body>
</html>
